function parseDB(csv) {
            // 1. 先把 CSV 拆成行，並過濾掉空行
            const rows = csv.split(/\r?\n/).map(r => r.trim()).filter(r => r !== "");
            
            // 2. 自動判斷分隔符 (逗號 或 Tab)
            const sep = csv.includes('\t') ? '\t' : ',';
            
            allDB = rows.slice(1).map((row, index) => {
                // 處理可能有引號包圍的欄位
                const cols = row.split(sep).map(c => c.replace(/^"|"$/g, '').trim());
                
                // 診斷：如果欄位不足，在控制台印出提醒
                if (cols.length < 9) {
                    console.warn(`第 ${index + 2} 列格式不全:`, row);
                    return null;
                }

                return {
                    id: cols[0], 
                    cat: cols[1].toUpperCase(), // 強制轉大寫，避免 SF vs sf 報錯
                    q: cols[3], 
                    opts: [cols[4], cols[5], cols[6], cols[7]], 
                    ans: cols[8], 
                    note: cols[9] || "無解析"
                };
            }).filter(q => q && q.q && q.ans);
            
            console.log("總共載入題目:", allDB.length);
        }

        function startMission() {
            // 診斷：各類別題目數量
            const sfPool = allDB.filter(q => q.cat === 'SF');
            const sdPool = allDB.filter(q => q.cat === 'SD');
            const mnPool = allDB.filter(q => q.cat === 'MN');

            console.log(`類別統計: SF=${sfPool.length}, SD=${sdPool.length}, MN=${mnPool.length}`);

            if (sfPool.length < 7 || sdPool.length < 7 || mnPool.length < 6) {
                alert(`⚠️ 獵場準備不足！\n\n目前庫存：\n字形(SF): ${sfPool.length} 題\n字音(SD): ${sdPool.length} 題\n字義(MN): ${mnPool.length} 題\n\n請確認您的 Google Sheet 中 'cat' 欄位填寫正確（必須是 SF, SD, MN）。`);
                return;
            }

            // 抽題邏輯
            const sf = sfPool.sort(() => 0.5 - Math.random()).slice(0, 7);
            const sd = sdPool.sort(() => 0.5 - Math.random()).slice(0, 7);
            const mn = mnPool.sort(() => 0.5 - Math.random()).slice(0, 6);
            
            missionSet = [...sf, ...sd, ...mn].sort(() => 0.5 - Math.random());
            
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            document.getElementById('quiz-progress').classList.remove('hidden');
            loadQuestion();
        }
