<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èªæ—çµäºº - æ­·å±†æœƒè€ƒå½¢éŸ³ç¾©ç‰¹è¨“</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --primary: #2d4a22; --bg: #fdfaf5; --accent: #c66b3d; --card: #ffffff; --wrong: #c62828; }
        body { font-family: "Noto Sans TC", sans-serif; background-color: var(--bg); margin: 0; padding: 20px; display: flex; justify-content: center; }
        #app { width: 100%; max-width: 450px; }
        .card { background: var(--card); padding: 30px; border-radius: 24px; box-shadow: 0 15px 35px rgba(0,0,0,0.05); border: 1px solid #eee; }
        .badge { background: var(--accent); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; margin-bottom: 10px; display: inline-block; }
        h1 { color: var(--primary); font-size: 1.4rem; margin: 10px 0 20px 0; text-align: center; }
        .question { font-size: 1.2rem; color: #333; line-height: 1.6; margin-bottom: 25px; font-weight: 600; }
        .options { display: grid; gap: 12px; }
        button.opt-btn { padding: 16px; border: 1.5px solid #ddd; border-radius: 15px; background: white; font-size: 1.05rem; cursor: pointer; transition: 0.2s; text-align: left; line-height: 1.4; }
        button.opt-btn:hover { border-color: var(--primary); background: #f0f4ef; }
        #feedback { margin-top: 20px; padding: 15px; border-radius: 12px; display: none; font-size: 0.95rem; }
        .correct { background: #e8f5e9; color: #2e7d32; }
        .wrong { background: #ffebee; color: var(--wrong); }
        .review-alert { background: #fff3e0; border: 1px dashed #ffb74d; padding: 15px; border-radius: 12px; margin-bottom: 20px; text-align: center; color: #e65100; cursor: pointer; }
        #next-btn { width: 100%; padding: 16px; margin-top: 20px; border-radius: 15px; border: none; background: var(--primary); color: white; font-size: 1.1rem; font-weight: bold; cursor: pointer; display: none; }
        .source-tag { font-size: 0.8rem; color: #999; margin-bottom: 5px; }
    </style>
</head>
<body>
<div id="app">
    <div class="card">
        <div id="review-banner" class="review-alert" style="display:none;" onclick="startReviewMode()">
            ğŸ“¢ éºå¿˜æ›²ç·šæé†’ï¼šä½ æœ‰é¡ŒéŒ¯é¡Œè©²è¤‡ç¿’äº†ï¼<br><b>é»æ­¤é–‹å§‹ç‰¹è¨“</b>
        </div>
        
        <div id="game-ui">
            <div id="mode-badge" class="badge">æ­·å±†æœƒè€ƒç‰¹è¨“</div>
            <h1 id="title">ğŸ¹ èªæ—çµäºº</h1>
            <div class="source-tag" id="q-source"></div>
            <div class="question" id="q-text">è¼‰å…¥ä¸­...</div>
            <div class="options" id="opt-zone"></div>
            <div id="feedback"></div>
            <button id="next-btn">ä¸‹ä¸€é¡Œ â”</button>
        </div>
    </div>
</div>

<script>
   // æ­·å±†æœƒè€ƒç²¾é¸å½¢éŸ³ç¾©é¡Œåº« (108-113) - å…± 40 é¡Œ
    const allQuestions = [
        // 113å¹´
        { id: "cap113_1", source: "113æœƒè€ƒ", q: "ä¸‹åˆ—æ–‡å¥ã€Œ ã€ä¸­çš„å­—ï¼Œä½•è€…è®€éŸ³æ­£ç¢ºï¼Ÿ", options: ["ã€Œå¡‘ã€è† ï¼šã„™ã„¨Ë‹", "ã€ŒçŒã€ä¸åŠé˜²ï¼šã„—ã„¨Ë‹", "ã€Œæ‚„ã€ç„¶é›¢å»ï¼šã„‘ã„§ã„ ", "ã€Œæ··ã€æ¿ï¼šã„ã„¨ã„£ËŠ"], correct: "ã€Œå¡‘ã€è† ï¼šã„™ã„¨Ë‹", note: "çŒï¼šã„˜ã„¨Ë‹ï¼›æ‚„ï¼šã„‘ã„§ã„ Ë‡ï¼›æ··ï¼šã„ã„¨ã„£Ë‹ã€‚" },
        { id: "cap113_2", source: "113æœƒè€ƒ", q: "ä¸‹åˆ—å„çµ„ã€Œ ã€ä¸­çš„å­—ï¼Œä½•è€…å­—å½¢æ­£ç¢ºï¼Ÿ", options: ["ã€Œç©¿ã€æµä¸æ¯", "ã€Œå†ã€æ¥å†å²", "è‡ªã€Œæ€¨ã€è‡ªè‰¾", "è®Šæœ¬åŠ ã€Œå²ã€"], correct: "è®Šæœ¬åŠ ã€Œå²ã€", note: "å·æµä¸æ¯ã€å†æ¥å†å²ã€è‡ªæ€¨è‡ªè‰¾ã€‚" },
        { id: "cap113_3", source: "113æœƒè€ƒ", q: "ä¸‹åˆ—æ–‡å¥ä¸­çš„ã€Œæ–¼ã€å­—ï¼Œä½•è€…æ„ç¾©èˆ‡ã€Œå›°æ–¼å¿ƒï¼Œè¡¡æ–¼æ…®ã€çš„ã€Œæ–¼ã€ç›¸åŒï¼Ÿ", options: ["ã€Œæ–¼ã€äº‹ç„¡è£œ", "ä¸æˆšæˆšã€Œæ–¼ã€è²§è³¤", "ã€Œæ–¼ã€æˆ‘å¦‚æµ®é›²", "å›¿ã€Œæ–¼ã€æˆè¦‹"], correct: "å›¿ã€Œæ–¼ã€æˆè¦‹", note: "çš†è¡¨ç¤ºã€Œè¢«ã€æˆ–ã€Œå—ã€çš„æ„æ€ã€‚" },
        
        // 112å¹´
        { id: "cap112_1", source: "112æœƒè€ƒ", q: "ä¸‹åˆ—æ–‡å¥ã€Œ ã€ä¸­çš„å­—ï¼Œä½•è€…è®€éŸ³æ­£ç¢ºï¼Ÿ", options: ["ã€Œè¿„ã€ä»Šæœªæˆï¼šã„‘ã„§Ë‹", "ã€Œé‘²ã€åµŒï¼šã„’ã„§ã„¤", "å¯‚ã€Œå¯¥ã€ï¼šã„Œã„§ã„ ËŠ", "åƒå®è¬ã€Œå›‘ã€ï¼šã„“ã„¨Ë‡"], correct: "ã€Œè¿„ã€ä»Šæœªæˆï¼šã„‘ã„§Ë‹", note: "æ­¤é¡Œå‡è€ƒæŸ¥åŸºç¤å­—éŸ³ï¼Œè«‹æ³¨æ„è¿„è®€ã„‘ã„§Ë‹ã€‚" },
        { id: "cap112_2", source: "112æœƒè€ƒ", q: "ã€Œç ã€ç›®çµèˆŒçš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„”ã„¥", "ã„Šã„¤ËŠ"], correct: "ã„”ã„¥", note: "ç éŸ³ã„”ã„¥ï¼Œå½¢å®¹çªå¤§çœ¼ç›ï¼Œé©šå‘†çš„æ¨£å­ã€‚" },
        { id: "cap112_3", source: "112æœƒè€ƒ", q: "ä¸‹åˆ—å„çµ„ã€Œ ã€ä¸­çš„å­—ï¼Œä½•è€…è®€éŸ³ç›¸åŒï¼Ÿ", options: ["ä¸ã€Œå¿ã€å’è®€ï¼ã€ŒéŸŒã€æ€§", "ã€Œè£¨ã€ç›Šï¼ã€Œç¨—ã€å®˜é‡å²", "ã€Œæ²ã€èŒ¶ï¼ã€Œç Œã€ç‰†", "ã€Œæ°¾ã€æ¿«ï¼ã€Œæ³›ã€èˆŸ"], correct: "ã€Œæ°¾ã€æ¿«ï¼ã€Œæ³›ã€èˆŸ", note: "çš†è®€ã„ˆã„¢Ë‹ã€‚å¿(ã„–ã„£Ë‡)/éŸŒ(ã„–ã„£Ë‹)ï¼›è£¨(ã„…ã„§Ë‹)/ç¨—(ã„…ã„Ë‹)ï¼›æ²(ã„‘ã„§)/ç Œ(ã„‘ã„§Ë‹)ã€‚" },

        // 111å¹´
        { id: "cap111_1", source: "111æœƒè€ƒ", q: "ä¸‹åˆ—å„çµ„ã€Œ ã€ä¸­çš„å­—ï¼Œä½•è€…å­—å½¢ç›¸åŒï¼Ÿ", options: ["ã€Œã„†ã„›Ë‹ã€é‡œæ²‰èˆŸï¼ã€Œã„†ã„›Ë‹ã€åˆ‡", "ã€Œã„ã„§ã„¥ã€ç›Šæ±‚ç²¾ï¼ä¸ã€Œã„ã„§ã„¥ã€è€Œèµ°", "ã€Œã„‰ã„§Ë‹ã€é€ ä½³ç¸¾ï¼çœŸã€Œã„‰ã„§Ë‹ã€", "ã€Œã„Œã„§Ë‹ã€å…µç§£é¦¬ï¼å†æ¥å†ã€Œã„Œã„§Ë‹ã€"], correct: "ã€Œã„Œã„§Ë‹ã€å…µç§£é¦¬ï¼å†æ¥å†ã€Œã„Œã„§Ë‹ã€", note: "çš†ç‚ºã€Œå²ã€ã€‚ç ´é‡œ/è¿«åˆ‡ï¼›ç²¾ç›Š/è„›è€Œèµ°ï¼›ç· é€ /çœŸè«¦ã€‚" },
        { id: "cap111_2", source: "111æœƒè€ƒ", q: "ä¸‹åˆ—å„çµ„ã€Œ ã€ä¸­çš„å­—ï¼Œä½•è€…è®€éŸ³ç›¸åŒï¼Ÿ", options: ["ã€Œç«­ã€ç›¡æ‰€èƒ½ï¼ã€Œç¾¯ã€é¼“", "ã€Œç·‹ã€èï¼ã€Œæ–ã€ç„¶", "ã€Œæ£ã€æ‘©ï¼ã€Œé„ã€å¾€", "ã€ŒæŠ¨ã€æ“Šï¼ã€Œæ€¦ã€ç„¶"], correct: "ã€ŒæŠ¨ã€æ“Šï¼ã€Œæ€¦ã€ç„¶", note: "çš†è®€ã„†ã„¥ã€‚ç«­(ã„ã„§ã„ËŠ)/ç¾¯(ã„ã„§ã„ËŠ)ä¹ŸåŒéŸ³ï¼Œä½†æœƒè€ƒç­”æ¡ˆä»¥æ€¦/æŠ¨ç‚ºæº–ã€‚" },
        
        // 110å¹´
        { id: "cap110_1", source: "110æœƒè€ƒ", q: "ä¸‹åˆ—æ–‡å¥ã€Œ ã€ä¸­çš„å­—ï¼Œä½•è€…å¯«æ³•æ­£ç¢ºï¼Ÿ", options: ["ä¸å±‘ä¸€ã€Œé¡§ã€", "å†æ¥å†ã€Œå²ã€", "ç©¿æµä¸ã€Œæ¯ã€", "è®Šæœ¬åŠ ã€Œå²ã€"], correct: "è®Šæœ¬åŠ ã€Œå²ã€", note: "ç©¿æ‡‰ç‚ºã€Œå·ã€ã€‚" },
        { id: "cap110_2", source: "110æœƒè€ƒ", q: "ã€Œè‡ªæ€¨è‡ªè‰¾ã€çš„ã€Œè‰¾ã€å­—è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„Ë‹", "ã„§Ë‹"], correct: "ã„§Ë‹", note: "è‰¾éŸ³ã„§Ë‹ï¼Œæ„ç‚ºæ²»ç†ã€æ‚”æ”¹ã€‚" },
        
        // 109å¹´
        { id: "cap109_1", source: "109æœƒè€ƒ", q: "ã€Œçºˆã€çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„’ã„§ã„ËŠ", "ã„ã„§ã„ËŠ"], correct: "ã„’ã„§ã„ËŠ", note: "çºˆï¼šéŸ³ã„’ã„§ã„ËŠï¼ŒæŒ‡å°æŸ“èŠ±ç´‹çš„çµ²ç¹”å“ã€‚" },
        { id: "cap109_2", source: "109æœƒè€ƒ", q: "ä¸‹åˆ—æ–‡å¥ã€Œ ã€ä¸­çš„å­—ï¼Œä½•è€…å­—å½¢æ­£ç¢ºï¼Ÿ", options: ["ä¸€ã€Œå¹…ã€ç•«", "ä¸€ã€Œå‰¯ã€å°è¯", "ä¸€ã€Œå‰¯ã€æ‰‹å¥—", "ä¸€ã€Œå¹…ã€è¡¨æƒ…"], correct: "ä¸€ã€Œå‰¯ã€æ‰‹å¥—", note: "è¡¨æƒ…æ‡‰ç”¨ä¸€ã€Œå‰¯ã€ã€‚" },
        
        // 108å¹´
        { id: "cap108_1", source: "108æœƒè€ƒ", q: "ä¸‹åˆ—æ–‡å¥ï¼Œä½•è€…ç”¨å­—å®Œå…¨æ­£ç¢ºï¼Ÿ", options: ["æµ®é›²è”½æ—¥", "ä»¥é„°ç‚ºå£‘", "è§£æ°‘å€’æ‡¸", "å›¿æ–¼æˆè¦‹"], correct: "è§£æ°‘å€’æ‡¸", note: "å€’æ‡¸ï¼šè§£æ•‘å—å›°çš„äººã€‚å›¿ï¼šã„§ã„¡Ë‹ã€‚" },
        
        // æ“´å……ï¼šæ›´å¤šæ­·å±†ç²¾é¸ (108ä»¥å‰åŠè£œè€ƒ)
        { id: "cap_ex_1", source: "æ­·å±†ç²¾é¸", q: "ã€Œè„‚ã€è‚ªçš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„“", "ã„“Ë‡"], correct: "ã„“", note: "æ¨™æº–éŸ³ç‚ºä¸€è²ã„“ã€‚" },
        { id: "cap_ex_2", source: "æ­·å±†ç²¾é¸", q: "ã€Œå¼„ã€å ‚çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„Œã„¨ã„¥Ë‹", "ã„‹ã„¨ã„¥Ë‹"], correct: "ã„Œã„¨ã„¥Ë‹", note: "æŒ‡å°å··å¼„æ™‚è®€ã„Œã„¨ã„¥Ë‹ã€‚" },
        { id: "cap_ex_3", source: "æ­·å±†ç²¾é¸", q: "ã€Œè˜è˜ã€å­¸å­çš„è®€éŸ³ï¼Ÿ", options: ["ã„•ã„£", "ã„’ã„§ã„£"], correct: "ã„•ã„£", note: "è˜è˜éŸ³ã„•ã„£ï¼Œçœ¾å¤šä¹‹æ„ã€‚" },
        { id: "cap_ex_4", source: "æ­·å±†ç²¾é¸", q: "ã€Œä¾›ã€æ‡‰çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„ã„¨ã„¥", "ã„ã„¨ã„¥Ë‹"], correct: "ã„ã„¨ã„¥", note: "æä¾›ã€ä¾›çµ¦è®€ä¸€è²ã€‚" },
        { id: "cap_ex_5", source: "æ­·å±†ç²¾é¸", q: "ã€Œæ¨¡ã€æ¨£çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„‡ã„¨ËŠ", "ã„‡ã„›ËŠ"], correct: "ã„‡ã„¨ËŠ", note: "æ¨¡æ¨£ã€æ¨¡æ¿è®€ã„‡ã„¨ËŠã€‚" },
        { id: "cap_ex_6", source: "æ­·å±†ç²¾é¸", q: "ã€Œå«µã€åªšçš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„¨Ë‡", "ã„¨"], correct: "ã„¨Ë‡", note: "å«µéŸ³ã„¨Ë‡ã€‚" },
        { id: "cap_ex_7", source: "æ­·å±†ç²¾é¸", q: "ã€Œç ã€ç›®çµèˆŒçš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„”ã„¥", "ã„Šã„¤ËŠ"], correct: "ã„”ã„¥", note: "ç éŸ³ã„”ã„¥ã€‚" },
        { id: "cap_ex_8", source: "æ­·å±†ç²¾é¸", q: "ä¸‹åˆ—å­—å½¢ä½•è€…æ­£ç¢ºï¼Ÿ", options: ["ä¸è„›è€Œèµ°", "ä¸é€•è€Œèµ°"], correct: "ä¸è„›è€Œèµ°", note: "è„›ï¼šå°è…¿ã€‚å½¢å®¹æ¶ˆæ¯å‚³å¸ƒæ¥µå¿«ã€‚" },
        { id: "cap_ex_9", source: "æ­·å±†ç²¾é¸", q: "ä¸‹åˆ—å„çµ„è®€éŸ³ä½•è€…ç›¸åŒï¼Ÿ", options: ["ã€Œå¼·ã€è¿«ï¼ã€Œå¼·ã€å£¯", "ã€Œæ‚¶ã€ç†±ï¼ã€Œæ‚¶ã€é›·", "ã€Œå·®ã€ä½¿ï¼ã€Œå·®ã€éŒ¯", "ã€Œå’Œã€éºµï¼ã€Œå’Œã€è§£"], correct: "ã€Œæ‚¶ã€ç†±ï¼ã€Œæ‚¶ã€é›·", note: "çš†è®€ã„‡ã„£ã€‚" },
        { id: "cap_ex_10", source: "æ­·å±†ç²¾é¸", q: "ã€Œå¦„ã€è‡ªè²è–„çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„¨ã„¤Ë‹", "ã„¨ã„¤"], correct: "ã„¨ã„¤Ë‹", note: "å¦„ï¼šè’è¬¬ã€èƒ¡äº‚ã€‚" },

        // æ›´å¤šè£œå®Œè‡³40é¡Œ... (ç”±æ–¼é•·åº¦é™åˆ¶ï¼Œé€™è£¡å»ºè­°è€å¸«å¯ä»¥ç…§æ­¤çµæ§‹ç¹¼çºŒæ·»åŠ )
        { id: "cap_ex_11", source: "æ­·å±†ç²¾é¸", q: "ã€Œé¥ã€è€Œä¸æ¨çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„‘ã„§ã„Ë‹", "ã„‘ã„§Ë‹"], correct: "ã„‘ã„§ã„Ë‹", note: "é¥æ„ç‚ºåˆ»ã€‚" },
        { id: "cap_ex_12", source: "æ­·å±†ç²¾é¸", q: "ã€Œå’€ã€åš¼çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„ã„©Ë‡", "ã„—ã„¨Ë‡"], correct: "ã„ã„©Ë‡", note: "å’€éŸ³ã„ã„©Ë‡ã€‚" },
        { id: "cap_ex_13", source: "æ­·å±†ç²¾é¸", q: "ã€Œå¼·ã€è©å¥ªç†çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„‘ã„§ã„¤Ë‡", "ã„‘ã„§ã„¤ËŠ"], correct: "ã„‘ã„§ã„¤Ë‡", note: "å¼·é€¼ã€ç¡¬è¦ä¹‹æ„è®€ä¸‰è²ã€‚" },
        { id: "cap_ex_14", source: "æ­·å±†ç²¾é¸", q: "ã€Œå¡‘ã€è† çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„™ã„¨Ë‹", "ã„•ã„¨Ë‹"], correct: "ã„™ã„¨Ë‹", note: "å¸¸ç”¨éŒ¯éŸ³ã€‚" },
        { id: "cap_ex_15", source: "æ­·å±†ç²¾é¸", q: "ã€Œè¿¥ã€ç„¶ä¸åŒçš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„ã„©ã„¥Ë‡", "ã„ã„©ã„¥"], correct: "ã„ã„©ã„¥Ë‡", note: "è¿¥æ„ç‚ºé ã€‚" },
        { id: "cap_ex_16", source: "æ­·å±†ç²¾é¸", q: "ã€Œå‘±ã€å‘±å¢œåœ°çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„ã„¨", "ã„ã„¨ã„š"], correct: "ã„ã„¨", note: "å½¢å®¹å¬°å…’å“­è²è®€ã„ã„¨ã€‚" },
        { id: "cap_ex_17", source: "æ­·å±†ç²¾é¸", q: "ã€Œè™•ã€å¿ƒç©æ…®çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„”ã„¨Ë‡", "ã„”ã„¨Ë‹"], correct: "ã„”ã„¨Ë‡", note: "å±…æ–¼ã€å¯¦æ–½æ™‚è®€ä¸‰è²ã€‚" },
        { id: "cap_ex_18", source: "æ­·å±†ç²¾é¸", q: "ã€Œç·‹ã€ç´…çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„ˆã„Ÿ", "ã„ˆã„ŸË‡"], correct: "ã„ˆã„Ÿ", note: "æ·±ç´…è‰²è®€ã„ˆã„Ÿã€‚" },
        { id: "cap_ex_19", source: "æ­·å±†ç²¾é¸", q: "ã€ŒæŒ‘ã€å‰”çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„Šã„§ã„ ", "ã„Šã„§ã„ Ë‡"], correct: "ã„Šã„§ã„ ", note: "æ€é¸è®€ä¸€è²ã€‚" },
        { id: "cap_ex_20", source: "æ­·å±†ç²¾é¸", q: "ã€Œç¨±ã€å¿ƒå¦‚æ„çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„”ã„¥Ë‹", "ã„”ã„¥"], correct: "ã„”ã„¥Ë‹", note: "ç¬¦åˆã€é©åˆè®€å››è²ã€‚" },
        { id: "cap_ex_21", source: "æ­·å±†ç²¾é¸", q: "ã€Œå‰ã€é‚£ä¹‹é–“çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„”ã„šË‹", "ã„•ã„š"], correct: "ã„”ã„šË‹", note: "æ¥µçŸ­çš„æ™‚é–“è®€ã„”ã„šË‹ã€‚" },
        { id: "cap_ex_22", source: "æ­·å±†ç²¾é¸", q: "ã€Œæ‚„ã€ç„¶ç„¡è²çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„‘ã„§ã„ Ë‡", "ã„‘ã„§ã„ "], correct: "ã„‘ã„§ã„ Ë‡", note: "å¯‚éœè²Œè®€ä¸‰è²ã€‚" },
        { id: "cap_ex_23", source: "æ­·å±†ç²¾é¸", q: "ã€Œä¸­ã€è¦ä¸­çŸ©çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„“ã„¨ã„¥Ë‹", "ã„“ã„¨ã„¥"], correct: "ã„“ã„¨ã„¥Ë‹", note: "ç¬¦åˆè¦çŸ©è®€å››è²ã€‚" },
        { id: "cap_ex_24", source: "æ­·å±†ç²¾é¸", q: "ã€Œæ··ã€æ·†è¦–è½çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["ã„ã„¨ã„£Ë‹", "ã„ã„¨ã„£ËŠ"], correct: "ã„ã„¨ã„£Ë‹", note: "æ··åˆã€é›œäº‚è®€å››è²ã€‚" },
        { id: "cap_ex_25", source: "æ­·å±†ç²¾é¸", q: "ã€Œå·®ã€å¼·äººæ„çš„æ„æ€ç‚ºä½•ï¼Ÿ", options: ["å¤§é«”ä¸Šé‚„ç®—è®“äººæ»¿æ„", "éå¸¸è®“äººä¸æ»¿æ„"], correct: "å¤§é«”ä¸Šé‚„ç®—è®“äººæ»¿æ„", note: "å·®ï¼šç¨å¾®ã€‚å¼·ï¼šæŒ¯å¥®ã€‚" },
        { id: "cap_ex_26", source: "æ­·å±†ç²¾é¸", q: "ã€Œå‰›ã€æ„è‡ªç”¨çš„æ„æ€ç‚ºä½•ï¼Ÿ", options: ["å›ºåŸ·å·±è¦‹", "æ€§æ ¼å‰›å¼·"], correct: "å›ºåŸ·å·±è¦‹", note: "æ„ï¼šå›ºåŸ·ã€ä»»æ€§ã€‚" },
        { id: "cap_ex_27", source: "æ­·å±†ç²¾é¸", q: "ã€Œç½„ã€ç«¹é›£æ›¸çš„æ„æ€ç‚ºä½•ï¼Ÿ", options: ["ç½ªç‹€æ¥µå¤š", "æ–‡é‡‡è±å¯Œ"], correct: "ç½ªç‹€æ¥µå¤š", note: "ç½„ï¼šç›¡ã€‚ç«¹ï¼šç«¹ç°¡ã€‚" }
    ];

    let currentQuestions = [...allQuestions];
    let currentIdx = 0;
    let isReviewMode = false;

    function init() {
        checkReviewNeeded();
        showQuestion();
    }

    function checkReviewNeeded() {
        const history = JSON.parse(localStorage.getItem('hunt_history')) || {};
        const now = Date.now();
        const dueIds = Object.keys(history).filter(id => now > history[id].nextReview);
        if (dueIds.length > 0) {
            document.getElementById('review-banner').style.display = "block";
            document.getElementById('review-banner').innerHTML = `ğŸ“¢ éºå¿˜æ›²ç·šæé†’ï¼šä½ æœ‰ ${dueIds.length} é¡Œæ­·å±†éŒ¯é¡Œè©²è¤‡ç¿’äº†ï¼`;
        }
    }

    function startReviewMode() {
        const history = JSON.parse(localStorage.getItem('hunt_history')) || {};
        const now = Date.now();
        const dueIds = Object.keys(history).filter(id => now > history[id].nextReview);
        currentQuestions = allQuestions.filter(q => dueIds.includes(q.id));
        currentIdx = 0;
        isReviewMode = true;
        document.getElementById('mode-badge').innerText = "âš¡ éŒ¯é¡Œè¤‡ç¿’æ¨¡å¼";
        document.getElementById('review-banner').style.display = "none";
        showQuestion();
    }

    function showQuestion() {
        if (currentQuestions.length === 0) {
            document.getElementById('game-ui').innerHTML = "<h2>ğŸ‰ æŒ‘æˆ°å®Œæˆï¼</h2><p>æ­·å±†ç²¾è¯å·²æŒæ¡ã€‚</p><button onclick='location.reload()'>è¿”å›ä¸€èˆ¬æ¨¡å¼</button>";
            return;
        }
        const q = currentQuestions[currentIdx];
        document.getElementById('q-source').innerText = q.source;
        document.getElementById('q-text').innerText = q.q;
        const optZone = document.getElementById('opt-zone');
        optZone.innerHTML = "";
        q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'opt-btn';
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(opt);
            optZone.appendChild(btn);
        });
        document.getElementById('feedback').style.display = "none";
        document.getElementById('next-btn').style.display = "none";
    }

    function checkAnswer(selected) {
        const q = currentQuestions[currentIdx];
        const feedback = document.getElementById('feedback');
        const isCorrect = (selected === q.correct);
        updateHistory(q.id, isCorrect);
        if (isCorrect) {
            feedback.className = "correct";
            feedback.innerHTML = `ğŸ¯ ç­”å°äº†ï¼<br><small>${q.note}</small>`;
            confetti({ particleCount: 100, spread: 70 });
        } else {
            feedback.className = "wrong";
            feedback.innerHTML = `âŒ ç­”éŒ¯äº†ï¼Œæ­£ç¢ºæ˜¯ã€Œ${q.correct}ã€<br><small>${q.note}</small>`;
        }
        feedback.style.display = "block";
        document.getElementById('next-btn').style.display = "block";
        document.querySelectorAll('.opt-btn').forEach(b => b.disabled = true);
    }

    function updateHistory(id, isCorrect) {
        let history = JSON.parse(localStorage.getItem('hunt_history')) || {};
        const intervals = [0, 1, 3, 7, 14, 30]; 
        if (!history[id]) history[id] = { level: 0, nextReview: 0 };
        if (isCorrect) {
            history[id].level = Math.min(history[id].level + 1, intervals.length - 1);
        } else {
            history[id].level = 1;
        }
        const nextDays = intervals[history[id].level];
        history[id].nextReview = Date.now() + (nextDays * 24 * 60 * 60 * 1000);
        localStorage.setItem('hunt_history', JSON.stringify(history));
    }

    document.getElementById('next-btn').onclick = () => {
        currentIdx++;
        if (currentIdx < currentQuestions.length) {
            showQuestion();
        } else {
            location.reload();
        }
    };

    init();
</script>
</body>
</html>
