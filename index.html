<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èªæ—çµäºº 4.3 - çµ‚æ¥µä¿®å¾©ç©©å®šç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --primary: #2d4a22; --pro: #5a4a78; --bg: #fdfaf5; --card: #ffffff; --accent: #c66b3d; }
        body { font-family: "Noto Sans TC", sans-serif; background-color: var(--bg); margin: 0; padding: 20px; display: flex; justify-content: center; }
        #app { width: 100%; max-width: 480px; }
        .card { background: var(--card); padding: 25px; border-radius: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        h1 { text-align: center; color: var(--primary); margin-bottom: 25px; font-size: 1.5rem; }
        .menu-section { margin-bottom: 20px; }
        .section-title { font-weight: bold; margin-bottom: 10px; color: #666; font-size: 0.9rem; border-left: 4px solid var(--accent); padding-left: 8px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .nav-btn { padding: 20px 10px; border: 1.5px solid #eee; border-radius: 16px; background: white; cursor: pointer; transition: 0.2s; text-align: center; border-bottom: 4px solid #ddd; }
        .nav-btn:active { transform: translateY(2px); border-bottom-width: 1px; }
        .btn-basic { border-bottom-color: var(--primary); }
        .btn-pro { border-bottom-color: var(--pro); }
        #game-ui { display: none; }
        .badge { padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; color: white; margin-bottom: 10px; display: inline-block; }
        .question { font-size: 1.15rem; line-height: 1.6; margin-bottom: 20px; padding: 20px; background: #f8f9fa; border-radius: 15px; min-height: 80px; font-weight: bold; }
        .options { display: grid; gap: 12px; }
        .opt-btn { padding: 15px; border: 1px solid #ddd; border-radius: 12px; background: white; text-align: left; cursor: pointer; font-size: 1.05rem; }
        #feedback { margin-top: 20px; padding: 15px; border-radius: 12px; display: none; line-height: 1.5; }
        .correct { background: #e8f5e9; color: #2e7d32; border: 1px solid #c8e6c9; }
        .wrong { background: #ffebee; color: #c62828; border: 1px solid #ffcdd2; }
        #next-btn { width: 100%; padding: 16px; margin-top: 20px; border-radius: 15px; border: none; background: #333; color: white; cursor: pointer; display: none; font-weight: bold; font-size: 1.1rem; }
        .exit-link { display: block; text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; color: #aaa; text-decoration: none; font-size: 0.85rem; }
    </style>
</head>
<body>
<div id="app">
    <div class="card">
        <div id="menu-ui">
            <h1>ğŸ¹ èªæ—çµäºº 4.3</h1>
            <div class="menu-section">
                <div class="section-title">åŸºç¤è¨“ç·´å€</div>
                <div class="grid">
                    <button class="nav-btn btn-basic" onclick="startLevel('basic_word')"><b>å½¢éŸ³ç¾©</b><small>ç²¾é¸ 40 é¡Œ</small></button>
                    <button class="nav-btn btn-basic" onclick="startLevel('basic_reading')"><b>æ–‡æ„å•Ÿè’™</b><small>åŸºç¤èªæ„Ÿ</small></button>
                </div>
            </div>
            <div class="menu-section">
                <div class="section-title">é«˜æ‰‹å¯¦æˆ°å€</div>
                <div class="grid">
                    <button class="nav-btn btn-pro" onclick="startLevel('pro_word')"><b>æœƒè€ƒå½¢éŸ³ç¾©</b><small>æ­·å±†çœŸé¡Œ</small></button>
                    <button class="nav-btn btn-pro" onclick="startLevel('pro_reading')"><b>æœƒè€ƒé–±è®€</b><small>åˆ¤è®€ç‰¹è¨“</small></button>
                </div>
            </div>
        </div>

        <div id="game-ui">
            <div id="mode-badge" class="badge"></div>
            <div id="q-source" style="font-size: 0.8rem; color: #999; margin-bottom: 5px; float: right;"></div>
            <div class="question" id="q-text"></div>
            <div class="options" id="opt-zone"></div>
            <div id="feedback"></div>
            <button id="next-btn">ç¢ºèªä¸‹ä¸€æ­¥ â”</button>
            <a href="javascript:void(0)" class="exit-link" onclick="confirmExit()">âœ• è¿”å›é¦–é </a>
        </div>
    </div>
</div>

<script>
    const allQuestions = [
        // --- åŸºç¤å½¢éŸ³ç¾© (40é¡Œå…¨éƒ¨è£œé½Š) ---
        { id: "bw1", cat: "basic_word", q: "ã€Œæ‹šã€å‘½å·¥ä½œçš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„†ã„¢Ë‹", "(B) ã„†ã„§ã„£"], correct: "(A) ã„†ã„¢Ë‹", note: "æ¨™æº–éŸ³ç‚ºå››è²ã„†ã„¢Ë‹ã€‚" },
        { id: "bw2", cat: "basic_word", q: "ã€Œè‡ªæ€¨è‡ªè‰¾ã€çš„ã€Œè‰¾ã€å­—è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„Ë‹", "(B) ã„§Ë‹"], correct: "(B) ã„§Ë‹", note: "è‰¾ï¼šæ²»ç†ã€æ‚”æ”¹ä¹‹æ„ã€‚" },
        { id: "bw3", cat: "basic_word", q: "ä¸‹åˆ—å­—å½¢ä½•è€…æ­£ç¢ºï¼Ÿ", options: ["(A) å†æ¥å†å²", "(B) å†æ¥å†å‹µ"], correct: "(A) å†æ¥å†å²", note: "å²ï¼šç£¨ç·´ã€‚" },
        { id: "bw4", cat: "basic_word", q: "ã€Œä¾›ã€æ‡‰éœ€æ±‚çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„ã„¨ã„¥", "(B) ã„ã„¨ã„¥Ë‹"], correct: "(A) ã„ã„¨ã„¥", note: "æä¾›ã€ä¾›çµ¦è®€ä¸€è²ã€‚" },
        { id: "bw5", cat: "basic_word", q: "ã€Œè„‚ã€è‚ªçš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„“", "(B) ã„“Ë‡"], correct: "(A) ã„“", note: "æ¨™æº–éŸ³ç‚ºä¸€è²ã„“ã€‚" },
        { id: "bw6", cat: "basic_word", q: "ä¸‹åˆ—ä½•è€…å­—å½¢æ­£ç¢ºï¼Ÿ", options: ["(A) ç ´é‡œæ²ˆèˆŸ", "(B) ç ´é‡œæ²‰èˆŸ"], correct: "(B) ç ´é‡œæ²‰èˆŸ", note: "æ²‰ï¼šæ‰å…¥æ°´ä¸­ã€‚" },
        { id: "bw7", cat: "basic_word", q: "ã€Œå¼„ã€å ‚çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„Œã„¨ã„¥Ë‹", "(B) ã„‹ã„¨ã„¥Ë‹"], correct: "(A) ã„Œã„¨ã„¥Ë‹", note: "æŒ‡å°å··å¼„æ™‚è®€ã„Œã„¨ã„¥Ë‹ã€‚" },
        { id: "bw8", cat: "basic_word", q: "ä¸‹åˆ—ä½•è€…ç”¨å­—æ­£ç¢ºï¼Ÿ", options: ["(A) è®Šæœ¬åŠ åˆ©", "(B) è®Šæœ¬åŠ å²"], correct: "(B) è®Šæœ¬åŠ å²", note: "å²ï¼šçŒ›çƒˆã€‚" },
        { id: "bw9", cat: "basic_word", q: "ã€Œè˜è˜ã€å­¸å­çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„’ã„§ã„£", "(B) ã„•ã„£"], correct: "(B) ã„•ã„£", note: "è˜è˜ï¼šçœ¾å¤šã€‚" },
        { id: "bw10", cat: "basic_word", q: "ã€Œæ¨¡ã€æ¨£çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„‡ã„›ËŠ", "(B) ã„‡ã„¨ËŠ"], correct: "(B) ã„‡ã„¨ËŠ", note: "æ¨¡æ¨£ã€æ¨¡æ¿è®€ã„‡ã„¨ËŠã€‚" },
        { id: "bw11", cat: "basic_word", q: "ã€ŒæŒ‘ã€å‰”çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„Šã„§ã„ ", "(B) ã„Šã„§ã„ Ë‡"], correct: "(A) ã„Šã„§ã„ ", note: "æ€é¸è®€ä¸€è²ã€‚" },
        { id: "bw12", cat: "basic_word", q: "ã€Œå«µã€åªšçš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„¨Ë‡", "(B) ã„¨"], correct: "(A) ã„¨Ë‡", note: "éŸ³ã„¨Ë‡ã€‚" },
        { id: "bw13", cat: "basic_word", q: "ã€Œç ã€ç›®çµèˆŒçš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„Šã„¤ËŠ", "(B) ã„”ã„¥"], correct: "(B) ã„”ã„¥", note: "éŸ³ã„”ã„¥ã€‚" },
        { id: "bw14", cat: "basic_word", q: "ã€Œé¥ã€è€Œä¸æ¨çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„‘ã„§ã„Ë‹", "(B) ã„‘ã„§Ë‹"], correct: "(A) ã„‘ã„§ã„Ë‹", note: "éŸ³ã„‘ã„§ã„Ë‹ã€‚" },
        { id: "bw15", cat: "basic_word", q: "ä¸‹åˆ—ä½•è€…å­—å½¢æ­£ç¢ºï¼Ÿ", options: ["(A) ä¸è„›è€Œèµ°", "(B) ä¸é€•è€Œèµ°"], correct: "(A) ä¸è„›è€Œèµ°", note: "è„›ï¼šå°è…¿ã€‚" },
        { id: "bw16", cat: "basic_word", q: "ã€Œå’€ã€åš¼çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„—ã„¨Ë‡", "(B) ã„ã„©Ë‡"], correct: "(B) ã„ã„©Ë‡", note: "éŸ³ã„ã„©Ë‡ã€‚" },
        { id: "bw17", cat: "basic_word", q: "ã€Œå¼·ã€è©å¥ªç†çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„‘ã„§ã„¤ËŠ", "(B) ã„‘ã„§ã„¤Ë‡"], correct: "(B) ã„‘ã„§ã„¤Ë‡", note: "å¼·é€¼è®€ä¸‰è²ã€‚" },
        { id: "bw18", cat: "basic_word", q: "ã€Œå¡‘ã€è† çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„•ã„¨Ë‹", "(B) ã„™ã„¨Ë‹"], correct: "(B) ã„™ã„¨Ë‹", note: "éŸ³ã„™ã„¨Ë‹ã€‚" },
        { id: "bw19", cat: "basic_word", q: "ã€Œè¿¥ã€ç„¶ä¸åŒçš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„ã„©ã„¥", "(B) ã„ã„©ã„¥Ë‡"], correct: "(B) ã„ã„©ã„¥Ë‡", note: "éŸ³ã„ã„©ã„¥Ë‡ã€‚" },
        { id: "bw20", cat: "basic_word", q: "ã€Œå‘±ã€å‘±å¢œåœ°çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„ã„¨ã„š", "(B) ã„ã„¨"], correct: "(B) ã„ã„¨", note: "å“­è²è®€ã„ã„¨ã€‚" },
        { id: "bw21", cat: "basic_word", q: "ã€Œè™•ã€å¿ƒç©æ…®çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„”ã„¨Ë‡", "(B) ã„”ã„¨Ë‹"], correct: "(A) ã„”ã„¨Ë‡", note: "å®šå¥ªè®€ä¸‰è²ã€‚" },
        { id: "bw22", cat: "basic_word", q: "ã€Œç·‹ã€ç´…çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„ˆã„ŸË‡", "(B) ã„ˆã„Ÿ"], correct: "(B) ã„ˆã„Ÿ", note: "éŸ³ã„ˆã„Ÿã€‚" },
        { id: "bw23", cat: "basic_word", q: "ã€Œç¨±ã€å¿ƒå¦‚æ„çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„”ç¨±", "(B) ã„”ç¨±Ë‹"], correct: "(B) ã„”ç¨±Ë‹", note: "ç¬¦åˆè®€å››è²ã€‚" },
        { id: "bw24", cat: "basic_word", q: "ã€Œå‰ã€é‚£ä¹‹é–“çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„•ã„š", "(B) ã„”ã„šË‹"], correct: "(B) ã„”ã„šË‹", note: "éŸ³ã„”ã„šË‹ã€‚" },
        { id: "bw25", cat: "basic_word", q: "ã€Œæ‚„ã€ç„¶ç„¡è²çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„‘ã„§ã„ ", "(B) ã„‘ã„§ã„ Ë‡"], correct: "(B) ã„‘ã„§ã„ Ë‡", note: "å¯‚éœè®€ä¸‰è²ã€‚" },
        { id: "bw26", cat: "basic_word", q: "ã€Œä¸­ã€è¦ä¸­çŸ©çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„“ã„¨ã„¥", "(B) ã„“ã„¨ã„¥Ë‹"], correct: "(B) ã„“ã„¨ã„¥Ë‹", note: "ç¬¦åˆè¦çŸ©ã€‚" },
        { id: "bw27", cat: "basic_word", q: "ã€Œæ··ã€æ·†è¦–è½çš„è®€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„ã„¨ã„£ËŠ", "(B) ã„ã„¨ã„£Ë‹"], correct: "(B) ã„ã„¨ã„£Ë‹", note: "éŸ³ã„ã„¨ã„£Ë‹ã€‚" },
        { id: "bw28", cat: "basic_word", q: "ä¸‹åˆ—å­—å½¢ä½•è€…æ­£ç¢ºï¼Ÿ", options: ["(A) å·æµä¸æ¯", "(B) ç©¿æµä¸æ¯"], correct: "(A) å·æµä¸æ¯", note: "å·ï¼šæ²³æµã€‚" },
        { id: "bw29", cat: "basic_word", q: "ã€Œå‰›æ„è‡ªç”¨ã€çš„ã€Œæ„ã€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„…ã„§Ë‹", "(B) ã„ˆã„¨Ë‹"], correct: "(A) ã„…ã„§Ë‹", note: "éŸ³ã„…ã„§Ë‹ã€‚" },
        { id: "bw30", cat: "basic_word", q: "ã€Œç½„ç«¹é›£æ›¸ã€çš„ã€Œç½„ã€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„‘ã„§ã„¥Ë‹", "(B) ã„†ã„¢ËŠ"], correct: "(A) ã„‘ã„§ã„¥Ë‹", note: "éŸ³ã„‘ã„§ã„¥Ë‹ã€‚" },
        { id: "bw31", cat: "basic_word", q: "ã€Œå¦„è‡ªè²è–„ã€çš„ã€Œè²ã€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„ˆã„Ÿ", "(B) ã„ˆã„ŸË‡"], correct: "(B) ã„ˆã„ŸË‡", note: "éŸ³ã„ˆã„ŸË‡ã€‚" },
        { id: "bw32", cat: "basic_word", q: "ã€Œä¸¦è¡Œä¸æ‚–ã€çš„ã€Œæ‚–ã€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„…ã„ŸË‹", "(B) ã„…ã„›ËŠ"], correct: "(A) ã„…ã„ŸË‹", note: "éŸ³ã„…ã„ŸË‹ã€‚" },
        { id: "bw33", cat: "basic_word", q: "ã€Œè‰è…äººå‘½ã€çš„ã€Œè…ã€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„ã„¨ã„¢Ë‡", "(B) ã„ã„§ã„¢"], correct: "(B) ã„ã„§ã„¢", note: "éŸ³ã„ã„§ã„¢ã€‚" },
        { id: "bw34", cat: "basic_word", q: "ã€Œå±å’¤é¢¨é›²ã€çš„ã€Œå’¤ã€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„“ã„šË‹", "(B) ã„”ã„šË‹"], correct: "(A) ã„“ã„šË‹", note: "éŸ³ã„“ã„šË‹ã€‚" },
        { id: "bw35", cat: "basic_word", q: "ã€Œé‡ç ­ã€æ™‚äº‹çš„ã€Œç ­ã€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„…ã„§ã„¢", "(B) ã„ˆã„¢Ë‡"], correct: "(A) ã„…ã„§ã„¢", note: "éŸ³ã„…ã„§ã„¢ã€‚" },
        { id: "bw36", cat: "basic_word", q: "ã€Œæˆ›ç„¶è€Œæ­¢ã€çš„ã€Œæˆ›ã€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„ã„šËŠ", "(B) ã„ã„§ã„šËŠ"], correct: "(B) ã„ã„§ã„šËŠ", note: "éŸ³ã„ã„§ã„šËŠã€‚" },
        { id: "bw37", cat: "basic_word", q: "ã€Œæ±—æµæµ¹èƒŒã€çš„ã€Œæµ¹ã€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„ã„§ã„šËŠ", "(B) ã„’ã„§ã„šËŠ"], correct: "(A) ã„ã„§ã„šËŠ", note: "éŸ³ã„ã„§ã„šËŠã€‚" },
        { id: "bw38", cat: "basic_word", q: "ã€Œæš´æ®„å¤©ç‰©ã€çš„ã€Œæ®„ã€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„“ã„£Ë‡", "(B) ã„Šã„§ã„¢Ë‡"], correct: "(B) ã„Šã„§ã„¢Ë‡", note: "éŸ³ã„Šã„§ã„¢Ë‡ã€‚" },
        { id: "bw39", cat: "basic_word", q: "ã€Œç›¸å½¢è¦‹çµ€ã€çš„ã€Œçµ€ã€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„“ã„¨ã„›ËŠ", "(B) ã„”ã„¨Ë‹"], correct: "(B) ã„”ã„¨Ë‹", note: "éŸ³ã„”ã„¨Ë‹ã€‚" },
        { id: "bw40", cat: "basic_word", q: "ã€Œä¸€æš´åå¯’ã€çš„ã€Œæš´ã€éŸ³ç‚ºä½•ï¼Ÿ", options: ["(A) ã„…ã„ Ë‹", "(B) ã„†ã„¨Ë‹"], correct: "(B) ã„†ã„¨Ë‹", note: "é€šã€Œæ›ã€ã€‚" },

        // --- åŸºç¤æ–‡æ„ ---
        { id: "br1", cat: "basic_reading", q: "ã€Œè‰¯è—¥è‹¦å£åˆ©æ–¼ç—…ï¼Œå¿ è¨€é€†è€³åˆ©æ–¼è¡Œã€‚ã€é€™å¥è©±å¼·èª¿ä»€éº¼ï¼Ÿ", options: ["(A) æ¥å—å‹¸èª¡æœ‰åŠ©é€²æ­¥", "(B) ç”Ÿç—…è¦åƒè—¥"], correct: "(A) æ¥å—å‹¸èª¡æœ‰åŠ©é€²æ­¥", note: "å¿ å‘Šé›–ç„¶é›£è½ä½†æœ‰ç›Šè™•ã€‚" },

        // --- é«˜æ‰‹å½¢éŸ³ç¾© ---
        { id: "pw1", cat: "pro_word", source: "113æœƒè€ƒ", q: "ä¸‹åˆ—æ–‡å¥ã€Œ ã€ä¸­çš„å­—ï¼Œä½•è€…è®€éŸ³æ­£ç¢ºï¼Ÿ", options: ["(A) ã€Œå¡‘ã€è† ï¼šã„™ã„¨Ë‹", "(B) ã€ŒçŒã€ä¸åŠé˜²ï¼šã„—ã„¨Ë‹", "(C) ã€Œæ‚„ã€ç„¶é›¢å»ï¼šã„‘ã„§ã„ ", "(D) ã€Œæ··ã€æ¿ï¼šã„ã„¨ã„£ËŠ"], correct: "(A) ã€Œå¡‘ã€è† ï¼šã„™ã„¨Ë‹", note: "113çœŸé¡Œã€‚çŒã„˜ã„¨Ë‹ã€æ‚„ã„‘ã„§ã„ Ë‡ã€‚" },

        // --- é«˜æ‰‹é–±è®€ ---
        { id: "pr1", cat: "pro_reading", source: "114åƒè€ƒå·", q: "é—œæ–¼æ–‡ä¸­æ–°ã€èˆŠã€Šäº”ä»£å²ã€‹å°å—å”å›ä¸»çš„è¨˜è¼‰ï¼Œä¸‹åˆ—æ•˜è¿°æœ€æ°ç•¶ï¼Ÿ", options: ["(A) ã€ŠèˆŠäº”ä»£å²ã€‹èªåŒå…¶æ­£çµ±", "(B) å—å”å›ä¸»åœ¨ã€ŠèˆŠäº”ä»£å²ã€‹å®šä½è¼ƒé«˜", "(C) å…©æ›¸çš†ç¨±å—å”å›ä¸»ç‚ºå¸"], correct: "(B) å—å”å›ä¸»åœ¨ã€ŠèˆŠäº”ä»£å²ã€‹å®šä½è¼ƒé«˜", note: "èˆŠå²è¨˜æ–¼ã€Œä¸–å®¶ã€ï¼Œæ–°å²è¨˜æ–¼ã€Œè¼‰è¨˜ã€ã€‚" }
    ];

    let currentSet = [];
    let currentIdx = 0;

    function startLevel(category) {
        currentSet = allQuestions.filter(q => q.cat === category);
        if(currentSet.length === 0) {
            alert("æ­¤å€åŸŸå°šæœªæ”¾å…¥é¡Œç›®ï¼Œæ•¬è«‹æœŸå¾…ï¼");
            return;
        }
        currentIdx = 0;
        document.getElementById('menu-ui').style.display = "none";
        document.getElementById('game-ui').style.display = "block";
        
        const badge = document.getElementById('mode-badge');
        badge.innerText = category.includes('basic') ? 'åŸºç¤ç‰¹è¨“' : 'é«˜æ‰‹å¯¦æˆ°';
        badge.style.background = category.includes('basic') ? 'var(--primary)' : 'var(--pro)';
        
        showQuestion();
    }

    function showQuestion() {
        const q = currentSet[currentIdx];
        document.getElementById('q-source').innerText = q.source || "ç‰¹è¨“é¡Œ";
        document.getElementById('q-text').innerText = (currentIdx + 1) + ". " + q.q;
        
        const optZone = document.getElementById('opt-zone');
        optZone.innerHTML = "";
        q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'opt-btn';
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(opt);
            optZone.appendChild(btn);
        });
        
        document.getElementById('feedback').style.display = "none";
        document.getElementById('next-btn').style.display = "none";
    }

    function checkAnswer(selected) {
        const q = currentSet[currentIdx];
        const feedback = document.getElementById('feedback');
        const isCorrect = (selected === q.correct);
        
        feedback.className = isCorrect ? "correct" : "wrong";
        feedback.innerHTML = isCorrect ? `ğŸ¯ ç­”å°äº†ï¼<br><small>${q.note}</small>` : `âŒ ç­”éŒ¯äº†ï¼Œæ­£ç¢ºç­”æ¡ˆæ˜¯ã€Œ${q.correct}ã€<br><small>${q.note}</small>`;
        feedback.style.display = "block";
        document.getElementById('next-btn').style.display = "block";
        
        if(isCorrect) confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
        document.querySelectorAll('.opt-btn').forEach(b => b.disabled = true);
    }

    document.getElementById('next-btn').onclick = () => {
        currentIdx++;
        if (currentIdx < currentSet.length) {
            showQuestion();
        } else {
            alert("ğŸ‰ å¤ªæ£’äº†ï¼æœ¬å–®å…ƒå…¨æ•¸å®Œæˆï¼");
            confirmExit();
        }
    };

    function confirmExit() {
        // ä¸éœ€è¦ location.reloadï¼Œç›´æ¥åˆ‡æ›ç•«é¢æœ€ç©©å®š
        document.getElementById('game-ui').style.display = "none";
        document.getElementById('menu-ui').style.display = "block";
    }
</script>
</body>
</html>
